
% IDENTIFICATION
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{ACM_TOMS_CALGO_User_Manual_Custom_Style}[2021/10/01 ACM TOMS_CALGO User Manual]

% PRELIMINARY DECLARATIONS
\RequirePackage[a4paper,
                twoside,
                headheight = 16pt,
                footskip = 43pt,
                left = 2cm,
                top = 2.5cm,
                right = 1.5cm,
                bottom = 2.5cm]{geometry}
\RequirePackage[english]{babel}
\RequirePackage[utf8]{inputenc}
\RequirePackage[backend=biber,
                style=numeric, 
                sorting=nyt]{biblatex}
\RequirePackage{csquotes}
\RequirePackage{wallpaper}
\RequirePackage{float}
\RequirePackage{ifthen, everypage}
\RequirePackage{amsmath, amssymb}
\RequirePackage{fancyhdr}
\RequirePackage{hyperref}
\RequirePackage{cleveref}
\RequirePackage{graphicx, eso-pic, transparent}
\RequirePackage{svg}
\RequirePackage{caption}
\RequirePackage{color}
\RequirePackage{listings}
\RequirePackage{fancybox}
\RequirePackage[utopia]{quotchap}
\RequirePackage{titlesec}
\RequirePackage{lmodern}
\RequirePackage{microtype}
\RequirePackage[listings]{tcolorbox}

% COMMANDS AND DEFINITIONS
\addbibresource{bibtex.bib}

\DeclareFixedFont{\RM}{T1}{ptm}{b}{n}{2cm}
%\UseRawInputEncoding

\definecolor{bashBlue}{RGB}{0,43,54}
\definecolor{bashLightBlue}{RGB}{114,159,207}
\definecolor{bashGray}{RGB}{197,197,197}
\definecolor{bashGreen}{RGB}{138,222,52}
\definecolor{darkGreen}{RGB}{0,80,0}
\definecolor{darkMagenta}{RGB}{128,0,128}
\definecolor{poliLightBlue}{RGB}{171,203,248}
\definecolor{poliGrayBlue}{RGB}{224,224,255}
\definecolor{poliDarkBlue}{RGB}{0,37,79}
\definecolor{poliOrange}{RGB}{255,99,0}

\newcommand{\changefont}{\ttfamily \fontsize{14}{9}\selectfont}
% Set transparent Poli Logo to appear on UL and UR for odd and even pages respectively
\makeatletter
\newcommand\WaterMark{
            \if@mainmatter
                \AddEverypageHook{\ClearWallPaper\ifthenelse{\isodd{\value{page}}}
                {\ThisULCornerWallPaper{0.35}{images/TransparentLogo.png}}                      {\ThisURCornerWallPaper{0.35}{images/TransparentLogo.png}}}
            \else
                \ClearWallPaper
            \fi
            }
\makeatother

% Define nested list bullets' style
\renewcommand{\labelitemi}{\color{poliDarkBlue} $\blacktriangleright $}
\renewcommand{\labelitemii}{\color{poliDarkBlue} $\blacksquare$}
\renewcommand{\labelitemiii}{\color{poliDarkBlue} $\bullet$}

% Define listing style for C++ scripts and files
\lstdefinestyle{CppStyle}{language=C++,
                          backgroundcolor=\color{poliGrayBlue},
                          basicstyle=\ttfamily\footnotesize,
                          commentstyle=\color{darkGreen},
                          keywordstyle=\color{poliDarkBlue},
                          otherkeywords={!,=,~},
                          morekeywords={!,=,~},
                          emphstyle={\color{darkMagenta}},
                          emph={int,char,double,float,unsigned,void,bool,return},
                          stringstyle=\color{red},
                          numberstyle=\ttfamily\tiny\color{black},
                          numbers=left,                    
                          numbersep=5pt,
                          breaklines=true,
                          postbreak=\mbox{\textcolor{red}{$\hookrightarrow$}\space},
                          breakatwhitespace=false,             
                          captionpos=b,                    
                          keepspaces=true,
                          showspaces=false,                
                          showstringspaces=false,
                          showtabs=false,                  
                          tabsize=2}
% Define listing style for make and  makefiles
\lstdefinestyle{MakeStyle}{language=[gnu] make,
                          backgroundcolor=\color{poliGrayBlue},
                          basicstyle=\ttfamily\footnotesize,
                          commentstyle=\color{darkGreen},
                          keywordstyle=\color{darkMagenta},
                          %keywords={$,\(,\),=},
                          %morekeywords={$,\(,\),=},
                          emphstyle={\color{poliOrange}},
                          emph={BLDDIR,INCDIR,SRCDIR,UTLDIR,OBJDIR},
                          stringstyle=\color{red},
                          numberstyle=\ttfamily\tiny\color{black},
                          numbers=left,                    
                          numbersep=5pt,
                          breaklines=true,
                          postbreak=\mbox{\textcolor{red}{$\hookrightarrow$}\space},
                          breakatwhitespace=false,             
                          captionpos=b,                    
                          keepspaces=true,
                          showspaces=false,                
                          showstringspaces=false,
                          showtabs=false,                  
                          tabsize=2}
% Define listing style for bash terminal commands
\lstdefinestyle{BashStyle}{language=bash,
                           backgroundcolor=\color{bashBlue},
                           basicstyle=\color{bashGreen} \ttfamily\footnotesize,
                           commentstyle=\color{yellow},
                           stringstyle=\color{magenta},
                           keywordstyle=\color{bashLightBlue},
                           keywords={sudo,home,g++,MTQR},
                           morekeywords={sudo,home,g++,MTQR},
                           numberstyle=\tiny\color{white},
                           numbers=none,
                           breaklines=true,
                           postbreak=\mbox{\textcolor{yellow}{$\hookrightarrow$}\space},
                           breakatwhitespace=false,                
                           captionpos=b,                    
                           keepspaces=true,
                           showspaces=false,                
                           showstringspaces=false,
                           showtabs=false,                  
                           tabsize=2}
% Define listing style for Windows PowerShell terminal commands
\lstdefinestyle{PSStyle}{language=bash,
                           backgroundcolor=\color{black},
                           basicstyle=\color{white} \ttfamily\footnotesize,
                           commentstyle=\color{white},
                           stringstyle=\color{white},
                           keywordstyle=\color{white},
                           numbers=none,
                           breaklines=true,
                           postbreak=\mbox{\textcolor{yellow}{$\hookrightarrow$}\space},
                           breakatwhitespace=false,                
                           captionpos=b,                    
                           keepspaces=true,
                           showspaces=false,                
                           showstringspaces=false,
                           showtabs=false,                  
                           tabsize=2}
% Define unique listing style for all custom-defined styles
\lstdefinestyle{Multiple}{style=CppStyle, style=BashStyle}


% OPTIONS & ADDITIONAL DECLARATIONS

% Set chapter font and appearance
\titleformat{\chapter}[display]
            {\normalfont\bfseries\color{poliDarkBlue}}
  {\filleft\hspace*{-60pt}%
    \rotatebox[origin=c]{90}{%
      \ttfamily\color{poliDarkBlue}\LARGE%
        \textls[180]{\textsc{\chaptertitlename}}%
    }\hspace{6pt}%
    {\setlength\fboxsep{0pt}\setlength{\fboxrule}{1pt}%
    \fcolorbox{poliDarkBlue}{poliOrange}{\parbox[c][3cm][c]{2.5cm}{%
        \centering\ttfamily\color{white}\fontsize{90}{90}\selectfont\thechapter}}
    }%
  }
  {10pt}
  {\titlerule[2.5pt]\vskip3pt\titlerule\vskip4pt\LARGE\sffamily}
% Set section font and appearance
\titleformat{\section}[hang]{}
{\changefont\bfseries\color{poliDarkBlue}\thesection}{8pt}{\bfseries\color{poliDarkBlue}\tiny}[{\color{%
    poliDarkBlue}\titlerule[2pt]}]
% Set section vertical separation
\titlespacing{\section}{0pt}{25pt}{12.5pt}
% Set subsection font and appearance
\titleformat{\subsection}[hang]{}
{\changefont\bfseries\color{poliDarkBlue}\thesubsection}{8pt}{\bfseries\color{poliDarkBlue}\tiny}[{\color{%
    poliDarkBlue}\titlerule[2pt]}]
% Reset headers/footers for mainmatter pages
\fancyhf{}
% Set headers
\fancyhead[LE]{\changefont \fcolorbox{black}{poliLightBlue}{\makebox[8mm]{\centering\color{black}{ \thepage}}}\bfseries\leftmark}
\fancyhead[RO]{\changefont \textbf{\rightmark} \fcolorbox{black}{poliLightBlue}{\makebox[8mm]{\color{black}{\thepage}}}}
\renewcommand{\headrulewidth}{0.25pt}
% Set footers
\fancyfoot[C]{\ttfamily \footnotesize MTQR User Manual}
\renewcommand{\footruleskip}{1.25cm}
% Enable the style
\pagestyle{fancy}
% Set the style for frontmatter and chapter pages
\fancypagestyle{plain}{\fancyhf{}
                       \fancyhead[LE,RO]{}
                       \renewcommand{\headrulewidth}{0pt}
                       \fancyfoot[C]{}}
% Set chapter and section appearance in the headers
\renewcommand{\chaptermark}[1]{\markboth{~#1}{}}
\renewcommand{\sectionmark}[1]{\markright{\thesection ~#1}}
% Set custom-style for listing
\lstset{style=Multiple}
% 
\tcbuselibrary{listings,skins}
% Override control sequence restriction for using \cleardoublepage within the document
\makeatletter
\def\cleardoublepage{\clearpage\if@twoside \ifodd\c@page\else
\hbox{}
\vspace*{\fill}
\thispagestyle{empty}
\newpage
\if@twocolumn\hbox{}\newpage\fi\fi\fi}
\makeatother